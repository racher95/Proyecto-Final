// Media queries centralizadas del sitio
// Siguiendo arquitectura 7-1, todas las reglas responsive están consolidadas aquí
// Uso: Este archivo importa mixins pero escribe @media directamente por compatibilidad

@use "../abstracts/variables" as m;
@use "sass:map";
@use "../responsive/mixins" as rmx;

// Breakpoint: Tablet y dispositivos medianos - Máximo 768px
// Afecta: Hero, Footer, layout general
@include rmx.mq("md") {
  // Carrito de compras: grid simplificado para tablets
  .cart-item {
    grid-template-columns: 80px 1fr;
    grid-template-rows: auto auto auto;
  }

  .cart-item-controls,
  .cart-item-total {
    grid-column: 1 / -1;
    justify-self: center;
  }

  .remove-btn {
    position: absolute;
    top: 1rem;
    right: 1rem;
  }

  .cart-summary {
    margin-left: 0;
    max-width: 100%;
  }

  // Títulos de secciones hero: reducir tamaño en tablets
  .hero h1,
  .catalog-hero h1,
  .about-hero h1 {
    font-size: 2rem;
  }

  // Footer: ajustar columnas responsivas
  .footer-container {
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
  }
}

// Breakpoint: Newsletter - Entre 480px y 735px
// Solo afecta al formulario de newsletter del footer
@include rmx.mq("sm", "md") {
  .newsletter-form {
    flex-direction: column;
    gap: map.get(m.$spaces, "sm") + 0.25rem;

    button {
      width: 100%;
      text-align: center;
    }
  }
}

// Breakpoint: Mobile - Máximo 480px
// Ajustes finales para pantallas muy pequeñas
@include rmx.mq("xs") {
  // Secciones hero: reducir padding y tamaño de título
  .hero,
  .catalog-hero,
  .about-hero {
    padding: 2rem 1rem;
  }

  .hero h1,
  .catalog-hero h1,
  .about-hero h1 {
    font-size: 1.5rem;
  }

  // Botones: reducir tamaño para mobile
  .btn {
    padding: map.get(m.$spaces, "sm") map.get(m.$spaces, "md");
    font-size: map.get(m.$font-sizes, "sm");
  }

  // Products grid mobile - ELIMINADO (bug de min-width en lugar de max-width)
  // .products-grid {
  //   grid-template-columns: 1fr;
  // }

  // Main container mobile
  main {
    padding: 1rem;
  }

  // Comentarios responsive - mobile (mantener al lado, solo reducir tamaño)
  .comment {
    gap: map.get(m.$spaces, "sm");
    padding: map.get(m.$spaces, "md");
  }

  .comment-avatar {
    width: 44px;
    height: 44px;
  }

  .comment-avatar-placeholder {
    font-size: 1rem;
  }

  .comment-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.5rem;
  }

  .comment-date {
    font-size: 0.8rem;
  }

  .comment-text {
    font-size: 0.9rem;
  }
}

// ===========================================================================
// CAROUSEL RESPONSIVE
// ===========================================================================
// Desktop grande (>1200px)
@media (min-width: 1201px) {
  .carousel-container {
    max-width: 1400px;
  }

  .carousel-track .product-card {
    $gap: map.get(m.$spaces, "md");

    flex: 0 0 calc((100% - (3 * #{$gap})) / 4);
    max-width: calc((100% - (3 * #{$gap})) / 4);
    min-width: 0;
  }
}

// Desktop mediano (769px - 1200px) - 3 tarjetas por fila
@media (min-width: 769px) and (max-width: 1200px) {
  .carousel-track .product-card {
    $gap: map.get(m.$spaces, "md");

    flex: 0 0 calc((100% - (2 * #{$gap})) / 3);
    max-width: calc((100% - (2 * #{$gap})) / 3);
    min-width: 0;
  }
}

// Tablet (481px - 768px) - 2 tarjetas por fila
@media (min-width: 481px) and (max-width: 768px) {
  .carousel-container {
    --carousel-inline-pad: #{map.get(m.$spaces, "2xl")};
    padding: 0 var(--carousel-inline-pad);
    scroll-padding-inline: var(--carousel-inline-pad);
  }

  .carousel-track .product-card {
    $gap: map.get(m.$spaces, "md");

    flex: 0 0 calc((100% - #{$gap}) / 2);
    max-width: calc((100% - #{$gap}) / 2);
    min-width: 0;
  }

  .section-title {
    font-size: 2rem;
  }

  .carousel-btn {
    width: 2.5rem;
    height: 2.5rem;
    font-size: 1.2rem;
  }

  // Product details responsive (tablet)
  .product-detail-grid {
    grid-template-columns: 1fr;
    gap: map.get(m.$spaces, "xl");
  }

  .product-gallery {
    position: static;
  }

  .main-image {
    height: 300px;
  }

  .product-actions-detail {
    flex-direction: column;
  }

  .product-price-large,
  .flash-price-large {
    font-size: 2rem;
  }

  .countdown-timer-detail {
    gap: map.get(m.$spaces, "xs");
  }

  .time-unit {
    min-width: 50px;
  }

  .time-number {
    font-size: 1.5rem;
    min-width: 40px;
    padding: map.get(m.$spaces, "xs");
  }

  .time-separator {
    font-size: 1.2rem;
  }

  .flash-price-section {
    flex-direction: column;
    align-items: flex-start;
    gap: map.get(m.$spaces, "sm");
  }

  #relatedProductsCarousel {
    padding: 0 map.get(m.$spaces, "2xl");
  }

  #relatedProductsCarousel .carousel-control-prev,
  #relatedProductsCarousel .carousel-control-next {
    width: 40px;
    height: 40px;
  }

  #relatedProductsCarousel .carousel-control-prev-icon,
  #relatedProductsCarousel .carousel-control-next-icon {
    width: 20px;
    height: 20px;
  }

  .related-product-image {
    height: 180px;
  }

  .related-product-name {
    font-size: map.get(m.$font-sizes, "base");
  }

  .related-product-price .price {
    font-size: 1.2rem;
  }

  .related-product-info {
    padding: map.get(m.$spaces, "md");
  }

  // Comentarios responsive - tablet (mantener al lado)
  .comment {
    gap: map.get(m.$spaces, "md");
    padding: map.get(m.$spaces, "md");
  }

  .comment-avatar {
    width: 50px;
    height: 50px;
  }

  .comment-avatar-placeholder {
    font-size: 1.2rem;
  }
}

@media (max-width: 640px) {
  .carousel-container {
    --carousel-inline-pad: #{map.get(m.$spaces, "lg")};
    padding: 0 var(--carousel-inline-pad);
    scroll-padding-inline: var(--carousel-inline-pad);
  }

  .carousel-track .product-card {
    flex: 0 0 100%;
    max-width: 100%;
    min-width: 0;
  }

  .section-title {
    font-size: 1.8rem;
    flex-direction: column;
    gap: map.get(m.$spaces, "sm");
  }
}

@media (max-width: 480px) {

  .features-grid {
    padding: 0 map.get(m.$spaces, "md");
    grid-template-columns: 1fr;
    gap: map.get(m.$spaces, "lg");
  }

  .feature {
    padding: map.get(m.$spaces, "lg");
  }

  main {
    padding: map.get(m.$spaces, "md");
  }

  .hero {
    padding: map.get(m.$spaces, "xl") map.get(m.$spaces, "md");
    border-radius: map.get(m.$radius, "xl");
    text-align: center;
    gap: map.get(m.$spaces, "md");
  }

  .hero h1 {
    font-size: map.get(m.$font-sizes, "xl");
    line-height: 1.2;
    margin-bottom: map.get(m.$spaces, "sm");
  }

  .hero p {
    font-size: map.get(m.$font-sizes, "sm");
    margin-bottom: map.get(m.$spaces, "lg");
  }

  .hero .btn {
    width: 100%;
    padding: map.get(m.$spaces, "sm") map.get(m.$spaces, "md");
  }
}

@include rmx.mq("xs") {
  .carousel-container {
    --carousel-inline-pad: #{map.get(m.$spaces, "lg")};
    padding: 0 var(--carousel-inline-pad);
    scroll-padding-inline: var(--carousel-inline-pad);
  }

  .carousel-btn {
    width: 2rem;
    height: 2rem;
    font-size: map.get(m.$font-sizes, "base");
  }

  #relatedProductsCarousel {
    padding: 0 map.get(m.$spaces, "xl");
  }

  #relatedProductsCarousel .carousel-control-prev,
  #relatedProductsCarousel .carousel-control-next {
    width: 35px;
    height: 35px;
  }

  #relatedProductsCarousel .carousel-control-prev {
    left: -5px;
  }

  #relatedProductsCarousel .carousel-control-next {
    right: -5px;
  }
}

// PÁGINA DE PRODUCTOS - RESPONSIVE

// Breakpoint: Tablets - Entre 481px y 768px
// Grid de productos adapta a 2-3 columnas según espacio disponible
@media (min-width: 481px) and (max-width: 768px) {
  .products-grid {
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  }
}

// Breakpoint: Mobile - Máximo 480px
// Grid de productos en una sola columna vertical
@media (max-width: 480px) {
  .products-grid {
    grid-template-columns: 1fr;
  }
}

// Breakpoint: Filtros horizontales - Mínimo 421px
// Controles de filtrado en layout de 2 filas
@media (min-width: 421px) {
  .controls-row {
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
    gap: 1rem;
  }

  .category-container,
  .price-filter-container {
    flex: 0 1 auto;
    min-width: 200px;
  }

  .sort-container,
  .view-toggle {
    flex: 0 1 auto;
    min-width: 150px;
    margin-top: 0.5rem;
  }

  .view-toggle {
    justify-content: flex-end;
  }
}

// Breakpoint: Filtros verticales - Máximo 420px
// Todos los controles apilados verticalmente
@media (max-width: 420px) {
  .controls-row {
    flex-direction: column;
    gap: 1rem;
    align-items: stretch;
  }

  .category-container,
  .sort-container,
  .price-filter-container,
  .view-toggle {
    width: 100%;
    justify-content: center;
  }

  .category-container select,
  .sort-container select {
    width: 100%;
    max-width: 280px;
  }

  .price-inputs {
    justify-content: center;
    max-width: 100%;

    input {
      width: 70px;
      min-width: 70px;
    }
  }

  .view-toggle {
    align-self: center;
  }
}

// PÁGINA SOBRE NOSOTROS - RESPONSIVE

// Breakpoint: Tablets y mobile - Máximo 768px
// Sección de historia cambia de 2 columnas a 1 columna
@media (max-width: 768px) {
  .story-content {
    grid-template-columns: 1fr;
    gap: 2rem;
  }
}

// ===========================================================================
// ABOUT PAGE RESPONSIVE
// ===========================================================================

// Tablet y mobile (≤768px): Story layout 1 columna
@media (max-width: 768px) {
  .story-content {
    grid-template-columns: 1fr;
    gap: 2rem;
  }
}

// NAVEGACIÓN PRINCIPAL - RESPONSIVE

// Breakpoint: Tablets y mobile - Máximo 768px
// Menú hamburguesa con navegación colapsable
@media (max-width: 768px) {
  .header-container {
    flex-wrap: wrap;
    padding: 1rem;
    position: relative;
  }

  // Menú móvil: oculto por defecto, se muestra con JavaScript
  .craftivity-nav {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background-color: var(--header-bg);
    box-shadow: var(--shadow-lg);
    border: 1px solid var(--header-border);
    flex-direction: column;
    gap: 0;
    padding: 1rem;
    border-radius: 0 0 15px 15px;
    display: none;
    z-index: 1000;

    /* Estado visible cuando JS agrega .show */
    &.show {
      display: flex;
    }

    /* Duplicar selectores para especificidad */
    &.show li,
    li {
      width: 100%;
      margin: 0.5rem 0;
      display: flex !important;
      flex-direction: column !important;
    }

    /* nav-search primera */
    &.show li:nth-child(2),
    li:nth-child(2) {
      order: 1 !important;
      margin-bottom: 1rem;
      border-bottom: 1px solid var(--border-secondary);
      padding-bottom: 1rem;
    }

    /* nav-links segunda */
    &.show li:nth-child(1),
    li:nth-child(1) {
      order: 2 !important;
    }

    /* nav-actions tercera */
    &.show li:nth-child(3),
    li:nth-child(3) {
      order: 3 !important;
      margin-top: 1rem;
      border-top: 1px solid var(--border-secondary);
      padding-top: 1rem;
    }
  }

  /* Configurar contenidos internos */
  .nav-links {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .nav-actions {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  /* Search-bar móvil */
  .nav-search .search-bar {
    min-width: auto;
    width: 100%;
    margin: 0;
  }

  /* Enlaces móviles */
  .nav-links a {
    display: block;
    padding: 1rem;
    border-radius: 8px;
    margin-bottom: 0.5rem;
    text-align: center;
    width: 100%;

    &:hover {
      background-color: #ecf0f1;
      transform: none;
    }
  }

  /* Botones móviles */
  .nav-actions .btn {
    display: block;
    margin: 0.5rem 0;
    text-align: center;
  }

  /* Header actions ocultas en móvil */
  .header-actions {
    display: none;
  }

  /* Menu toggle */
  .menu-toggle {
    display: flex;
    order: 3;
    margin-left: auto;
  }

  /* Animación hamburguesa */
  .menu-toggle.active span:nth-child(1) {
    transform: rotate(-45deg) translate(-6px, 6px);
  }

  .menu-toggle.active span:nth-child(2) {
    opacity: 0;
  }

  .menu-toggle.active span:nth-child(3) {
    transform: rotate(45deg) translate(-6px, -6px);
  }

  /* Logo order */
  .logo {
    order: 1;
  }

  .search-bar {
    min-width: 100%;
    max-width: 100%;
  }
}

// Desktop (≥769px) - Navegación horizontal
@media (min-width: 769px) {
  .craftivity-nav {
    display: flex;
    align-items: center;
    gap: 2.5rem;
  }

  .menu-toggle {
    display: none;
  }

  .header-actions {
    display: flex;
  }
}

// PÁGINA DE DETALLE DE PRODUCTO - RESPONSIVE

// Breakpoint: Tablets y laptops pequeños - Máximo 991px
// Ajusta margen superior de badges de producto
@media (max-width: 991px) {
  .product-badges-detail {
    margin-top: 0;
  }
}

// PÁGINA DE CARRITO - RESPONSIVE

// Breakpoint: Tablets y mobile - Máximo 768px
// Cambia de 2 columnas a 1 columna vertical
@media (max-width: 768px) {
  .cart-content.show {
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }

  .cart-summary {
    position: static;
    max-width: 100%;
  }

  .cart-item {
    grid-template-columns: 80px 1fr;
    grid-template-rows: auto auto auto;
    gap: 1rem;

    .cart-item-image {
      grid-row: 1 / 3;
      width: 80px;
      height: 80px;
    }

    .cart-item-details {
      grid-column: 2;
      grid-row: 1;
      padding-left: 0.5rem;
    }

    .cart-item-controls {
      grid-column: 1 / 2;
      grid-row: 3;
      justify-content: center;
    }

    .cart-item-total {
      grid-column: 2 / 3;
      grid-row: 2;
      text-align: right;
      padding-right: 0.5rem;
    }

    .remove-btn {
      grid-column: 2 / 3;
      grid-row: 3;
      justify-self: end;
    }
  }
}
